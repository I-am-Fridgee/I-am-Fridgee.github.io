<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fridgee's Site</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #89f7fe, #66a6ff);
            color: #fff;
            text-align: center;
            overflow-y: auto;
            height: 100vh;
        }

        .content {
            position: relative;
            z-index: 2;
            background: rgba(0, 0, 0, 0.6);
            margin: 50px auto;
            padding: 20px;
            border-radius: 15px;
            max-width: 600px;
            box-shadow: 0 0 15px rgba(0,0,0,0.5);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        p {
            font-size: 1.2rem;
            margin: 10px 0;
        }

        .fridge {
            position: absolute;
            width: 100px;
            opacity: 0.7;
            animation: float 10s infinite ease-in-out;
        }

        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg); }
            50% { transform: translateY(50vh) rotate(180deg); }
            100% { transform: translateY(-150px) rotate(360deg); }
        }

        .joke {
            margin-top: 20px;
            font-style: italic;
            color: #ffd;
        }
        @keyframes card-flip {
            0% { transform: rotateY(90deg); }
            100% { transform: rotateY(0deg); }
        }
    </style>
</head>
<body>
    <!-- Blackjack Game UI -->
    <div id="blackjack-game-container" style="position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);z-index:10;display:none;width:80%;max-width:700px;background:rgba(0,0,0,0.8);padding:20px;border-radius:15px;box-shadow:0 0 20px #000;">
        <h2 style="margin-top:0;text-align:center;">Blackjack</h2>
        <div id="blackjack-game">
            <div id="dealer-hand" style="margin-bottom:20px;">
                <h3>Dealer's Hand: <span id="dealer-score">?</span></h3>
                <div id="dealer-cards" style="display:flex;justify-content:center;gap:10px;min-height:100px;"></div>
            </div>
            <div id="player-hand" style="margin-bottom:20px;">
                <h3>Your Hand: <span id="player-score">0</span></h3>
                <div id="player-cards" style="display:flex;justify-content:center;gap:10px;min-height:100px;"></div>
            </div>
            <div id="blackjack-controls" style="text-align:center;">
                <div id="blackjack-message" style="margin-bottom:10px;font-size:1.2rem;min-height:20px;">Place your bet to start!</div>
                <input type="number" id="blackjack-bet-amount" placeholder="Bet Amount" min="1" style="width:150px;padding:8px;margin-right:10px;border-radius:5px;border:none;">
                <button id="blackjack-deal-btn" onclick="blackjackDeal()" style="padding:10px 20px;border:none;border-radius:5px;background:#4CAF50;color:#fff;cursor:pointer;">Deal</button>
                <button id="blackjack-hit-btn" onclick="blackjackHit()" style="padding:10px 20px;border:none;border-radius:5px;background:#2196F3;color:#fff;cursor:pointer;display:none;">Hit</button>
                <button id="blackjack-stand-btn" onclick="blackjackStand()" style="padding:10px 20px;border:none;border-radius:5px;background:#FF9800;color:#fff;cursor:pointer;display:none;">Stand</button>
                <button id="blackjack-close-btn" onclick="toggleUpgrade('blackjackGame')" style="padding:10px 20px;border:none;border-radius:5px;background:#f44336;color:#fff;cursor:pointer;margin-left:10px;">Close</button>
            </div>
        </div>
    </div>

    <!-- Dice Game UI -->
    <div id="dice-game-container" style="position:fixed;bottom:30px;left:30px;z-index:10;display:none;">
        <div id="dice-game" style="width:200px;height:260px;background:rgba(255,255,255,0.15);border-radius:30px;box-shadow:0 4px 20px #0006;position:relative;padding:20px;">
            <div style="text-align:center;">
                <h3 style="margin-top:0;">Dice Roll</h3>
                <div id="dice-display" style="font-size:3rem;margin:10px 0;">üé≤</div>
                <div id="dice-result" style="margin-bottom:10px;min-height:20px;"></div>
                <input type="number" id="dice-bet-amount" placeholder="Bet Amount" min="1" style="width:80%;padding:5px;margin-bottom:10px;border-radius:5px;border:none;">
                <div style="display:flex;justify-content:space-around;">
                    <button id="bet-even-btn" onclick="rollDice('even')" style="padding:8px 12px;border:none;border-radius:15px;background:#4CAF50;color:#fff;cursor:pointer;">Bet Even</button>
                    <button id="bet-odd-btn" onclick="rollDice('odd')" style="padding:8px 12px;border:none;border-radius:15px;background:#ff5e62;color:#fff;cursor:pointer;">Bet Odd</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Gambling Machine UI -->
    <div id="gumball-container" style="position:fixed;bottom:30px;right:30px;z-index:10;">
            <div id="gumball-machine" style="width:160px;height:260px;background:rgba(255,255,255,0.15);border-radius:30px 30px 60px 60px;box-shadow:0 4px 20px #0006;position:relative;padding:20px 20px 40px 20px;">
                    <div style="text-align:center;">
                            <div id="reels" style="display:flex;justify-content:center;align-items:center;font-size:2.5rem;height:48px;margin-bottom:10px;">
                                    <span id="reel1">üç¨</span>
                                    <span id="reel2">üç¨</span>
                                    <span id="reel3">üç¨</span>
                            </div>
                            <button id="spin-btn" style="margin-top:10px;padding:8px 24px;font-size:1.1rem;border-radius:20px;border:none;background:#ff5e62;color:#fff;cursor:pointer;box-shadow:0 2px 8px #0003;">Pull Handle</button>
                            <div id="gumball-result" style="margin-top:12px;min-height:30px;font-size:1.1rem;"></div>
                    </div>
                    <div id="toggle-machine" style="position:absolute;bottom:-30px;left:50%;transform:translateX(-50%);width:40px;height:60px;background:#c0c0c0;border-radius:20px;box-shadow:0 2px 8px #0003;cursor:pointer;"></div>
            </div>
    </div>

    <!-- Dollar Sign Button -->
    <button id="dollar-btn" title="Click for money!" style="position:fixed;top:30px;right:30px;z-index:10;font-size:2.2rem;background:gold;border:none;border-radius:50%;width:54px;height:54px;box-shadow:0 2px 8px #0003;cursor:pointer;display:flex;align-items:center;justify-content:center;">üí≤</button>
    
    <!-- Wallet Display -->
    <div id="wallet-display" style="position:fixed;top:30px;right:100px;z-index:10;font-size:1.5rem;font-weight:bold;color:#fff;text-shadow:2px 2px 4px #000;background:rgba(0,0,0,0.6);padding:8px 16px;border-radius:20px;">$0</div>
    
    <!-- Shop Button -->
    <button id="shop-btn" title="Open Shop" style="position:fixed;top:30px;right:200px;z-index:10;font-size:1.5rem;background:#4CAF50;border:none;border-radius:50%;width:44px;height:44px;box-shadow:0 2px 8px #0003;cursor:pointer;display:flex;align-items:center;justify-content:center;">üõí</button>

    <!-- Floating fridges -->
    <img src="https://www.leons.ca/cdn/shop/products/Shopify_JPEG-L2_57G18101_LRT18S4AWWC_F_3qtr_800x.jpg?v=1694460768" class="fridge" style="left:5%; animation-duration: 12s;">
    <img src="https://www.leons.ca/cdn/shop/products/Shopify_JPEG-L2_57G18101_LRT18S4AWWC_F_3qtr_800x.jpg?v=1694460768" class="fridge" style="left:40%; animation-duration: 15s;">
    <img src="https://www.leons.ca/cdn/shop/products/Shopify_JPEG-L2_57G18101_LRT18S4AWWC_F_3qtr_800x.jpg?v=1694460768" class="fridge" style="left:70%; animation-duration: 18s;">
    
    <!-- Shop Modal -->
    <div id="shop-modal" style="position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);background:rgba(0,0,0,0.9);color:#fff;padding:30px;border-radius:20px;z-index:100;display:none;max-width:400px;width:80%;max-height:80vh;box-shadow:0 0 20px #000;overflow-y:auto;">
        <h2 style="margin-top:0;text-align:center;">Upgrades Shop</h2>
        <div style="margin:20px 0;">
            <div style="margin-bottom:15px;padding:15px;background:rgba(255,255,255,0.1);border-radius:10px;">
                <h3>Double Click ($50)</h3>
                <p>Earn $2 per click instead of $1</p>
                <button id="buy-doubleClick" onclick="buyUpgrade('doubleClick')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;background:#ccc;margin-right:8px;">Buy</button>
                <button id="toggle-doubleClick" onclick="toggleUpgrade('doubleClick')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;display:none;">OFF</button>
            </div>
            <div style="margin-bottom:15px;padding:15px;background:rgba(255,255,255,0.1);border-radius:10px;">
                <h3>Triple Click ($200)</h3>
                <p>Earn $3 per click instead of $1</p>
                <button id="buy-tripleClick" onclick="buyUpgrade('tripleClick')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;background:#ccc;margin-right:8px;">Buy</button>
                <button id="toggle-tripleClick" onclick="toggleUpgrade('tripleClick')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;display:none;">OFF</button>
            </div>

            <div style="margin-bottom:15px;padding:15px;background:rgba(255,255,255,0.1);border-radius:10px;">
                <h3>Click Power II ($1500)</h3>
                <p>Increase your base click value by 1 (stacks with Double/Triple Click)</p>
                <button id="buy-clickPowerII" onclick="buyUpgrade('clickPowerII')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;background:#ccc;margin-right:8px;">Buy</button>
                <button id="toggle-clickPowerII" onclick="toggleUpgrade('clickPowerII')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;display:none;">OFF</button>
            </div>
            <div style="margin-bottom:15px;padding:15px;background:rgba(255,255,255,0.1);border-radius:10px;">
                <h3>Confetti Click ($75)</h3>
                <p>Get confetti every time you click</p>
                <button id="buy-confettiClick" onclick="buyUpgrade('confettiClick')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;background:#ccc;margin-right:8px;">Buy</button>
                <button id="toggle-confettiClick" onclick="toggleUpgrade('confettiClick')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;display:none;">OFF</button>
            </div>
            <div style="margin-bottom:15px;padding:15px;background:rgba(255,255,255,0.1);border-radius:10px;">
                <h3>Auto Clicker ($300)</h3>
                <p>Earn $1 every 10 seconds automatically</p>
                <button id="buy-autoClicker" onclick="buyUpgrade('autoClicker')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;background:#ccc;margin-right:8px;">Buy</button>
                <button id="toggle-autoClicker" onclick="toggleUpgrade('autoClicker')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;display:none;">OFF</button>
            </div>
            <div style="margin-bottom:15px;padding:15px;background:rgba(255,255,255,0.1);border-radius:10px;">
                <h3>Auto Clicker Boost ($1000)</h3>
                <p>Increase Auto Clicker earnings from $1 to $5 every 10 seconds</p>
                <button id="buy-autoClickerBoost" onclick="buyUpgrade('autoClickerBoost')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;background:#ccc;margin-right:8px;">Buy</button>
                <button id="toggle-autoClickerBoost" onclick="toggleUpgrade('autoClickerBoost')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;display:none;">OFF</button>
            </div>
            <div style="margin-bottom:15px;padding:15px;background:rgba(255,255,255,0.1);border-radius:10px;">
                <h3>Golden Dollar ($500)</h3>
                <p>Double your click value permanently</p>
                <button id="buy-goldenDollar" onclick="buyUpgrade('goldenDollar')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;background:#ccc;margin-right:8px;">Buy</button>
                <button id="toggle-goldenDollar" onclick="toggleUpgrade('goldenDollar')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;display:none;">OFF</button>
            </div>
            <div style="margin-bottom:15px;padding:15px;background:rgba(255,255,255,0.1);border-radius:10px;">
                <h3>Lucky Gambler ($150)</h3>
                <p>Better odds at the gambling machine</p>
                <button id="buy-luckyGambler" onclick="buyUpgrade('luckyGambler')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;background:#ccc;margin-right:8px;">Buy</button>
                <button id="toggle-luckyGambler" onclick="toggleUpgrade('luckyGambler')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;display:none;">OFF</button>
            </div>
            <div style="margin-bottom:15px;padding:15px;background:rgba(255,255,255,0.1);border-radius:10px;">
                <h3>Dice Game ($500)</h3>
                <p>Unlocks a simple dice game where you can bet on even or odd</p>
                <button id="buy-diceGame" onclick="buyUpgrade('diceGame')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;background:#ccc;margin-right:8px;">Buy</button>
                <button id="toggle-diceGame" onclick="toggleUpgrade('diceGame')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;display:none;">OFF</button>
            </div>
            <div style="margin-bottom:15px;padding:15px;background:rgba(255,255,255,0.1);border-radius:10px;">
                <h3>Blackjack Game ($1000)</h3>
                <p>Unlocks the classic card game Blackjack with cool visuals</p>
                <button id="buy-blackjackGame" onclick="buyUpgrade('blackjackGame')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;background:#ccc;margin-right:8px;">Buy</button>
                <button id="toggle-blackjackGame" onclick="toggleUpgrade('blackjackGame')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;display:none;">OFF</button>
            </div>
            <div style="margin-bottom:15px;padding:15px;background:rgba(255,255,255,0.1);border-radius:10px;">
                <h3>Background Theme ($80)</h3>
                <p>Change the background to a cool theme</p>
                <button id="buy-backgroundTheme" onclick="buyUpgrade('backgroundTheme')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;background:#ccc;margin-right:8px;">Buy</button>
                <button id="toggle-backgroundTheme" onclick="toggleUpgrade('backgroundTheme')" style="padding:8px 16px;border:none;border-radius:5px;cursor:pointer;display:none;">OFF</button>
            </div>
        </div>
        <button onclick="document.getElementById('shop-modal').style.display='none'" style="padding:10px 20px;background:#ff5e62;color:#fff;border:none;border-radius:5px;cursor:pointer;width:100%;margin-top:20px;">Close Shop</button>
    </div>

    <!-- Main Content -->
    <div class="content">
        <h1>Hello this is Fridgee's Site about me</h1>
        <p>Email: <b>IamFridgee@gmail.com</b></p>
        <div class="joke" id="joke"></div>
    </div>
    
    <script>
        // Shop button functionality
        document.getElementById('shop-btn').onclick = function() {
            const modal = document.getElementById('shop-modal');
            modal.style.display = 'block';
            updateShopButtons();
        };
        
        // Close modal when clicking outside or on close button
        window.onclick = function(event) {
            const modal = document.getElementById('shop-modal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        };
        
        // Close shop with escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                document.getElementById('shop-modal').style.display = 'none';
            }
        });
    </script>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    @media (max-width: 700px) {
        .content {
            margin: 18px 4vw;
            padding: 12px;
            max-width: 98vw;
        }
        #gumball-container {
            right: 10px !important;
            bottom: 10px !important;
            transform: scale(0.82);
        }
        #dollar-btn {
            right: 10px !important;
            top: 10px !important;
            width: 44px !important;
            height: 44px !important;
            font-size: 1.5rem !important;
        }
        .fridge {
            width: 60px !important;
        }
        #gamble-msg {
            left: 10px !important;
            bottom: 10px !important;
            font-size: 1rem !important;
            padding: 8px 14px !important;
        }
    }
</style>
<!-- Gambling Message Box -->
<div id="gamble-msg" style="position:fixed;left:30px;bottom:30px;z-index:11;background:rgba(0,0,0,0.7);color:#fff;padding:12px 22px;border-radius:14px;font-size:1.15rem;box-shadow:0 2px 8px #0003;">
    Let's go Gambling!
</div>
    
    <script>
        // Game state
        let money = 0;
        let clickValue = 1;
        let upgrades = {
            doubleClick: { bought: false, active: false, cost: 50 },
            tripleClick: { bought: false, active: false, cost: 200 },
            clickPowerII: { bought: false, active: false, cost: 1500 }, // New: Further increase click value
            confettiClick: { bought: false, active: false, cost: 75 },
            autoClicker: { bought: false, active: false, cost: 300 },
            autoClickerBoost: { bought: false, active: false, cost: 1000 }, // New: Increase auto-clicker value
            goldenDollar: { bought: false, active: false, cost: 500 },
            luckyGambler: { bought: false, active: false, cost: 150 },
            diceGame: { bought: false, active: false, cost: 500 }, // New: Dice Game
            blackjackGame: { bought: false, active: false, cost: 1000 }, // New: Blackjack Game
            backgroundTheme: { bought: false, active: false, cost: 80 }
        };
        let autoClickerInterval = null;

        // Update money display
        function updateMoneyDisplay() {
            const walletDisplay = document.getElementById('wallet-display');
            if (walletDisplay) {
                walletDisplay.innerText = `$${money}`;
            }
            // Update shop buttons after money changes for real-time feedback
            updateShopButtons();
            saveGame(); // Save game state whenever money is updated
        }

        // Save game state to localStorage
        function saveGame() {
            const gameData = {
                money: money,
                clickValue: clickValue,
                upgrades: upgrades
            };
            localStorage.setItem('fridgeeGame', JSON.stringify(gameData));
        }

        // Load game state from localStorage
        function loadGame() {
            const savedData = localStorage.getItem('fridgeeGame');
            if (savedData) {
                const gameData = JSON.parse(savedData);
                money = gameData.money || 0;
                clickValue = gameData.clickValue || 1;
                
                // Merge with default upgrades to ensure all properties exist
                const defaultUpgrades = {
                    doubleClick: { bought: false, active: false, cost: 50 },
                    tripleClick: { bought: false, active: false, cost: 200 },
                    clickPowerII: { bought: false, active: false, cost: 1500 },
                    confettiClick: { bought: false, active: false, cost: 75 },
                    autoClicker: { bought: false, active: false, cost: 300 },
                    autoClickerBoost: { bought: false, active: false, cost: 1000 },
                    goldenDollar: { bought: false, active: false, cost: 500 },
                    luckyGambler: { bought: false, active: false, cost: 150 },
                    diceGame: { bought: false, active: false, cost: 500 },
                    blackjackGame: { bought: false, active: false, cost: 1000 },
                    backgroundTheme: { bought: false, active: false, cost: 80 }
                };
                
                upgrades = { ...defaultUpgrades, ...(gameData.upgrades || {}) };
                
                // Apply active upgrades
                applyActiveUpgrades();
                updateMoneyDisplay();
                updateShopButtons();
            }
        }

        // Update shop buttons based on purchase status
        function updateShopButtons() {
            Object.keys(upgrades).forEach(upgradeKey => {
                const btn = document.getElementById(`buy-${upgradeKey}`);
                const toggleBtn = document.getElementById(`toggle-${upgradeKey}`);
                if (btn) {
                    const upgrade = upgrades[upgradeKey];
                    if (upgrade.bought) {
                        btn.disabled = true;
                        btn.innerText = 'Purchased';
                        btn.style.background = '#4CAF50';
                        if (toggleBtn) {
                            toggleBtn.style.display = 'inline-block';
                            toggleBtn.innerText = upgrade.active ? 'ON' : 'OFF';
                            toggleBtn.style.background = upgrade.active ? '#4CAF50' : '#ff5e62';
                        }
                    } else if (money >= upgrade.cost) {
                        btn.disabled = false;
                        btn.style.background = '#4CAF50';
                        if (toggleBtn) toggleBtn.style.display = 'none';
                    } else {
                        btn.disabled = true;
                        btn.style.background = '#ccc';
                        if (toggleBtn) toggleBtn.style.display = 'none';
                    }
                }
            });
        }

        // Apply all active upgr        function applyActiveUpgrades() {
            // Reset clickValue before applying
            clickValue = 1;
            stopAutoClicker(); // Stop to restart if active

            // Hide all mini-games first
            document.getElementById('dice-game-container').style.display = 'none';
            document.getElementById('blackjack-game-container').style.display = 'none';

            Object.keys(upgrades).forEach(upgradeKey => {
                const upgrade = upgrades[upgradeKey];
                if (upgrade.bought && upgrade.active) {
                    switch(upgradeKey) {
                        case 'autoClicker':
                            startAutoClicker();
                            break;
                        case 'diceGame':
                            document.getElementById('dice-game-container').style.display = 'block';
                            break;
                        case 'blackjackGame':
                            document.getElementById('blackjack-game-container').style.display = 'flex';
                            break;
                        // Other upgrades are applied when used
                    }
                }
            });ElementById('blackjack-game-container').style.display = 'flex';
                            break;
                        // Other upgrades are applied when used
                    }
                }
            });
            // Re-apply logic for mutually exclusive click upgrades
            let baseClickValue = 1;
            if (upgrades.tripleClick.bought && upgrades.tripleClick.active) {
                baseClickValue = 3;
            } else if (upgrades.doubleClick.bought && upgrades.doubleClick.active) {
                baseClickValue = 2;
            }
            if (upgrades.clickPowerII.bought && upgrades.clickPowerII.active) {
                baseClickValue += 1; // Further increase click value
            }
            clickValue = baseClickValue;

            // Apply golden dollar multiplier last
            if (upgrades.goldenDollar.bought && upgrades.goldenDollar.active) {
                clickValue *= 2;
            }
        }

        // Toggle upgrade function
        function toggleUpgrade(upgradeKey) {
            const upgrade = upgrades[upgradeKey];
            if (upgrade.bought) {
                upgrade.active = !upgrade.active;

                // Mutual exclusivity for mini-games
                if (upgradeKey === 'diceGame' && upgrade.active && upgrades.blackjackGame.active) {
                    upgrades.blackjackGame.active = false;
                } else if (upgradeKey === 'blackjackGame' && upgrade.active && upgrades.diceGame.active) {
                    upgrades.diceGame.active = false;
                }
                
                // Re-apply all upgrades to handle mutual exclusivity and dependencies correctly
                applyActiveUpgrades();
                
                updateShopButtons();
                updateMoneyDisplay(); // updateMoneyDisplay now calls saveGame()
                showPurchaseMessage(`${upgradeKey.replace(/([A-Z])/g, ' $1').toLowerCase()} turned ${upgrade.active ? 'ON' : 'OFF'}`);
            }
        }

        let autoClickerValue = 1;

        function startAutoClicker() {
            if (autoClickerInterval) clearInterval(autoClickerInterval);
            autoClickerValue = (upgrades.autoClickerBoost.bought && upgrades.autoClickerBoost.active) ? 5 : 1;
            autoClickerInterval = setInterval(() => {
                money += autoClickerValue;
                updateMoneyDisplay();
            }, 10000);
        }

        function stopAutoClicker() {
            if (autoClickerInterval) {
                clearInterval(autoClickerInterval);
                autoClickerInterval = null;
            }
        }

        // Buy upgrade function
        function buyUpgrade(upgradeKey) {
            const upgrade = upgrades[upgradeKey];
            if (!upgrade.bought && money >= upgrade.cost) {
                money -= upgrade.cost;
                upgrade.bought = true;
                upgrade.active = true; // Auto-activate when bought
                
                // Re-apply all upgrades to handle mutual exclusivity and dependencies correctly
                applyActiveUpgrades();
                
                updateMoneyDisplay(); // updateMoneyDisplay now calls saveGame()
                updateShopButtons();
                showPurchaseMessage(`Upgrade purchased: ${upgradeKey.replace(/([A-Z])/g, ' $1').toLowerCase()}`);
            } else if (!upgrade.bought && money < upgrade.cost) {
                showPurchaseMessage(`Not enough money! Need $${upgrade.cost - money} more.`);
            }
        }

        // Dice Game Logic
        function rollDice(betType) {
            const betInput = document.getElementById('dice-bet-amount');
            const betAmount = parseInt(betInput.value);
            const resultDiv = document.getElementById('dice-result');
            const diceDisplay = document.getElementById('dice-display');

            if (upgrades.diceGame.bought && !upgrades.diceGame.active) {
                resultDiv.innerText = "Dice Game is currently turned off in the shop.";
                return;
            }

            if (isNaN(betAmount) || betAmount <= 0) {
                resultDiv.innerText = "Please enter a valid bet amount.";
                return;
            }

            if (betAmount > money) {
                resultDiv.innerText = "You don't have enough money to place that bet!";
                return;
            }

            // Dice roll (1-6)
            const roll = Math.floor(Math.random() * 6) + 1;
            const isEven = roll % 2 === 0;
            const rollType = isEven ? 'even' : 'odd';
            
            // Update dice display
            const diceFaces = ['‚öÄ', '‚öÅ', '‚öÇ', '‚öÉ', '‚öÑ', '‚öÖ'];
            diceDisplay.innerText = diceFaces[roll - 1];

            if (betType === rollType) {
                money += betAmount;
                resultDiv.innerText = `You won! Rolled a ${roll} (${rollType}). +$${betAmount}`;
            } else {
                money -= betAmount;
                resultDiv.innerText = `You lost! Rolled a ${roll} (${rollType}). -$${betAmount}`;
            }

            updateMoneyDisplay();
            betInput.value = ''; // Clear bet amount
        }

        // Blackjack Game Logic
        let deck = [];
        let playerHand = [];
        let dealerHand = [];
        let blackjackBet = 0;

        function createDeck() {
            const suits = ['‚ô•', '‚ô¶', '‚ô£', '‚ô†'];
            const values = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
            deck = [];
            for (let suit of suits) {
                for (let value of values) {
                    deck.push({ value, suit });
                }
            }
            // Shuffle the deck
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
        }

        function getCardValue(card) {
            if (['K', 'Q', 'J'].includes(card.value)) return 10;
            if (card.value === 'A') return 11;
            return parseInt(card.value);
        }

        function calculateScore(hand) {
            let score = 0;
            let hasAce = 0;
            for (let card of hand) {
                score += getCardValue(card);
                if (card.value === 'A') hasAce++;
            }
            while (score > 21 && hasAce > 0) {
                score -= 10;
                hasAce--;
            }
            return score;
        }

        function drawCard(hidden = false) {
            if (deck.length === 0) createDeck(); // Reshuffle if deck is empty
            const card = deck.pop();
            return { ...card, hidden };
        }

        function renderCard(card) {
            const color = (card.suit === '‚ô•' || card.suit === '‚ô¶') ? 'red' : 'black';
            const cardHtml = `
                <div class="card" style="
                    width: 60px; height: 90px; background: ${card.hidden ? '#333' : 'white'}; 
                    border: 1px solid #ccc; border-radius: 5px; box-shadow: 2px 2px 5px rgba(0,0,0,0.5);
                    display: flex; flex-direction: column; justify-content: space-between; align-items: center;
                    font-size: 1.2rem; font-weight: bold; color: ${color}; padding: 5px;
                    transition: transform 0.3s ease-out;
                    animation: card-flip 0.5s;
                ">
                    ${card.hidden ? '<span style="font-size: 2rem; color: gold;">?</span>' : `
                        <span style="align-self: flex-start;">${card.value}</span>
                        <span style="font-size: 1.5rem;">${card.suit}</span>
                        <span style="align-self: flex-end; transform: rotate(180deg);">${card.value}</span>
                    `}
                </div>
            `;
            return cardHtml;
        }

        function updateBlackjackUI(hideDealerFirst = true) {
            document.getElementById('player-cards').innerHTML = playerHand.map(renderCard).join('');
            document.getElementById('player-score').innerText = calculateScore(playerHand);

            const dealerCards = dealerHand.map((card, index) => {
                if (index === 0 && hideDealerFirst) {
                    return renderCard({ value: '', suit: '', hidden: true });
                }
                return renderCard(card);
            }).join('');
            document.getElementById('dealer-cards').innerHTML = dealerCards;
            document.getElementById('dealer-score').innerText = hideDealerFirst ? '?' : calculateScore(dealerHand);
        }

        function setBlackjackControls(deal, hit, stand) {
            document.getElementById('blackjack-deal-btn').style.display = deal ? 'inline-block' : 'none';
            document.getElementById('blackjack-hit-btn').style.display = hit ? 'inline-block' : 'none';
            document.getElementById('blackjack-stand-btn').style.display = stand ? 'inline-block' : 'none';
            document.getElementById('blackjack-bet-amount').disabled = !deal;
        }

        function blackjackDeal() {
            const betInput = document.getElementById('blackjack-bet-amount');
            const betAmount = parseInt(betInput.value);
            const messageDiv = document.getElementById('blackjack-message');

            if (upgrades.blackjackGame.bought && !upgrades.blackjackGame.active) {
                messageDiv.innerText = "Blackjack is currently turned off in the shop.";
                return;
            }

            if (isNaN(betAmount) || betAmount <= 0) {
                messageDiv.innerText = "Please enter a valid bet amount.";
                return;
            }

            if (betAmount > money) {
                messageDiv.innerText = "You don't have enough money to place that bet!";
                return;
            }

            // Deduct bet and start game
            blackjackBet = betAmount;
            money -= blackjackBet;
            updateMoneyDisplay();

            createDeck();
            playerHand = [];
            dealerHand = [];

            // Deal initial cards
            playerHand.push(drawCard());
            dealerHand.push(drawCard());
            playerHand.push(drawCard());
            dealerHand.push(drawCard(true)); // Dealer's first card is hidden

            updateBlackjackUI(true);
            setBlackjackControls(false, true, true);
            messageDiv.innerText = "Hit or Stand?";

            // Check for immediate Blackjack
            if (calculateScore(playerHand) === 21) {
                messageDiv.innerText = "Blackjack! You win 1.5x!";
                blackjackEndGame(true, true);
            }
        }

        function blackjackHit() {
            playerHand.push(drawCard());
            updateBlackjackUI(true);
            const score = calculateScore(playerHand);
            const messageDiv = document.getElementById('blackjack-message');

            if (score > 21) {
                messageDiv.innerText = "Bust! You lose.";
                blackjackEndGame(false);
            } else if (score === 21) {
                blackjackStand();
            }
        }

        function blackjackStand() {
            setBlackjackControls(false, false, false);
            const messageDiv = document.getElementById('blackjack-message');
            
            // Reveal dealer's first card
            dealerHand[0].hidden = false;
            updateBlackjackUI(false);

            // Dealer hits until score is 17 or more
            let dealerScore = calculateScore(dealerHand);
            const dealerPlay = setInterval(() => {
                if (dealerScore < 17) {
                    dealerHand.push(drawCard());
                    updateBlackjackUI(false);
                    dealerScore = calculateScore(dealerHand);
                } else {
                    clearInterval(dealerPlay);
                    blackjackDetermineWinner();
                }
            }, 1000);
        }

        function blackjackDetermineWinner() {
            const playerScore = calculateScore(playerHand);
            const dealerScore = calculateScore(dealerHand);
            const messageDiv = document.getElementById('blackjack-message');

            if (dealerScore > 21) {
                messageDiv.innerText = "Dealer busts! You win!";
                blackjackEndGame(true);
            } else if (playerScore > dealerScore) {
                messageDiv.innerText = "You win!";
                blackjackEndGame(true);
            } else if (playerScore < dealerScore) {
                messageDiv.innerText = "Dealer wins! You lose.";
                blackjackEndGame(false);
            } else {
                messageDiv.innerText = "Push! Bet returned.";
                blackjackEndGame(true, false, true); // Push
            }
        }

        function blackjackEndGame(win, blackjack = false, push = false) {
            setBlackjackControls(true, false, false);
            document.getElementById('blackjack-bet-amount').value = '';

            if (push) {
                money += blackjackBet;
            } else if (win) {
                const multiplier = blackjack ? 2.5 : 2; // 1.5x profit for blackjack (2.5x return), 1x profit for win (2x return)
                money += blackjackBet * multiplier;
            }
            // If lose, money is already deducted

            updateMoneyDisplay();
        }



        function showPurchaseMessage(message) {
            const msg = document.createElement('div');
            msg.innerText = message;
            msg.style.position = 'fixed';
            msg.style.top = '50%';
            msg.style.left = '50%';
            msg.style.transform = 'translate(-50%, -50%)';
            msg.style.background = 'rgba(0,0,0,0.8)';
            msg.style.color = '#fff';
            msg.style.padding = '15px 25px';
            msg.style.borderRadius = '10px';
            msg.style.zIndex = 10000;
            document.body.appendChild(msg);
            setTimeout(() => msg.remove(), 2000);
        }

        const symbols = [
                {emoji: "7Ô∏è‚É£", name: "Jackpot", weight: 2},
                {emoji: "ü§ë", name: "Money", weight: 5},
                {emoji: "?", name: "Mystery", weight: 8},
                {emoji: "üçû", name: "Bread", weight: 10},
                {emoji: "üç¨", name: "Candy", weight: 12},
                {emoji: "üçé", name: "Apple", weight: 14},
        ];

        function weightedRandomSymbol() {
                const total = symbols.reduce((sum, s) => sum + s.weight, 0);
                let r = Math.random() * total;
                for (const s of symbols) {
                        if (r < s.weight) return s.emoji;
                        r -= s.weight;
                }
                return symbols[symbols.length-1].emoji;
        }

        const reels = [document.getElementById('reel1'), document.getElementById('reel2'), document.getElementById('reel3')];
        const spinBtn = document.getElementById('spin-btn');
        const resultDiv = document.getElementById('gumball-result');
        let spinning = false;

        function spinReelsAnimation(final, duration=4500) {
                const start = Date.now();
                const interval = 80;
                let spinInterval = setInterval(() => {
                    reels.forEach(r => r.innerText = weightedRandomSymbol());
                }, interval);

                setTimeout(() => {
                    clearInterval(spinInterval);
                    let steps = [0, 200, 400];
                    reels.forEach((r, i) => {
                        setTimeout(() => { r.innerText = final[i]; }, steps[i]);
                    });
                    setTimeout(() => {
                        spinning = false;
                        checkResult(final);
                    }, Math.max(...steps) + 400);
                }, duration);
        }

        function checkResult(final) {
                if (final[0] === final[1] && final[1] === final[2]) {
                        switch(final[0]) {
                                case "7Ô∏è‚É£":
                                        const jackpotReward = clickValue * 50;
                                        money += jackpotReward;
                                        updateMoneyDisplay();
                                        resultDiv.innerHTML = `üéâ JACKPOT! <b>+${jackpotReward} Clicks!</b> <span style='font-size:2rem;'>üéäüéäüéä</span>`;
                                        confetti();
                                        break;
                                case "ü§ë":
                                        const moneyReward = clickValue * 10;
                                        money += moneyReward;
                                        updateMoneyDisplay();
                                        resultDiv.innerHTML = `üí∞ MONEY! +$${moneyReward}! <span style='font-size:2rem;'>ü§ëü§ëü§ë</span>`;
                                        moneyConfetti();
                                        break;
                                case "?":
                                        resultDiv.innerHTML = "‚ùì Mystery! The colors are changing!";
                                        randomizeColors();
                                        break;
                                case "üçû":
                                case "üç¨":
                                case "üçé":
                                        const standardReward = clickValue * 5;
                                        money += standardReward;
                                        updateMoneyDisplay();
                                        resultDiv.innerHTML = `‚úÖ Triple Match! +${standardReward} Clicks!`;
                                        break;
                                default:
                                        const defaultReward = clickValue * 5;
                                        money += defaultReward;
                                        updateMoneyDisplay();
                                        resultDiv.innerHTML = `‚úÖ Triple Match! +${defaultReward} Clicks!`;
                        }
                } else {
                        resultDiv.innerHTML = "Try again!";
                }
        }

        spinBtn.onclick = function() {
                if (spinning) return;
                spinning = true;
                resultDiv.innerHTML = "";
                const final = [weightedRandomSymbol(), weightedRandomSymbol(), weightedRandomSymbol()];
                spinReelsAnimation(final, 4000 + Math.random()*2000);
        };

        function confetti() {
                for(let i=0;i<30;i++) {
                        let c = document.createElement('div');
                        c.innerText = "üéä";
                        c.style.position = 'fixed';
                        c.style.left = (10 + Math.random()*80) + '%';
                        c.style.top = '-40px';
                        c.style.fontSize = (1.5 + Math.random()) + 'rem';
                        c.style.pointerEvents = 'none';
                        c.style.zIndex = 9999;
                        document.body.appendChild(c);
                        setTimeout(() => {
                                c.style.transition = 'top 2.5s cubic-bezier(.2,.8,.2,1)';
                                c.style.top = (60 + Math.random()*30) + '%';
                        }, 10);
                        setTimeout(() => c.remove(), 2600);
                }
        }

        function moneyConfetti() {
                for(let i=0;i<25;i++) {
                        let c = document.createElement('div');
                        c.innerText = "üíµ";
                        c.style.position = 'fixed';
                        c.style.left = (15 + Math.random()*70) + '%';
                        c.style.top = '-40px';
                        c.style.fontSize = (1.3 + Math.random()) + 'rem';
                        c.style.pointerEvents = 'none';
                        c.style.zIndex = 9999;
                        document.body.appendChild(c);
                        setTimeout(() => {
                                c.style.transition = 'top 2.2s cubic-bezier(.2,.8,.2,1)';
                                c.style.top = (60 + Math.random()*30) + '%';
                        }, 10);
                        setTimeout(() => c.remove(), 2300);
                }
        }

        // Toggle gambling machine visibility
        document.getElementById('toggle-machine').onclick = function() {
                const machine = document.getElementById('gumball-machine');
                const reelsContainer = document.getElementById('reels');
                const spinButton = document.getElementById('spin-btn');
                const resultDisplay = document.getElementById('gumball-result');
                
                if (reelsContainer.style.display === 'none') {
                        reelsContainer.style.display = 'flex';
                        spinButton.style.display = 'block';
                        resultDisplay.style.display = 'block';
                } else {
                        reelsContainer.style.display = 'none';
                        spinButton.style.display = 'none';
                        resultDisplay.style.display = 'none';
                }
        };

        function randomizeColors() {
                const c1 = `#${Math.floor(Math.random()*0xFFFFFF).toString(16).padStart(6,'0')}`;
                const c2 = `#${Math.floor(Math.random()*0xFFFFFF).toString(16).padStart(6,'0')}`;
                document.body.style.background = `linear-gradient(135deg, ${c1}, ${c2})`;
                setTimeout(() => {
                        document.body.style.background = '';
                }, 4000);
        }

        document.getElementById('dollar-btn').onclick = function() {
                money += clickValue;
                updateMoneyDisplay();
                
                let d = document.createElement('div');
                d.innerHTML = `<span style='font-size:2.5rem;'>üí∏üí∏üí∏</span><br><b>+${clickValue}!</b><br>Total: $${money}`;
                d.style.position = 'fixed';
                d.style.top = '80px';
                d.style.right = '40px';
                d.style.background = '#fff';
                d.style.color = '#222';
                d.style.padding = '18px 30px';
                d.style.borderRadius = '18px';
                d.style.boxShadow = '0 2px 12px #0004';
                d.style.zIndex = 9999;
                document.body.appendChild(d);
                
                if (upgrades.confettiClick.bought && upgrades.confettiClick.active) {
                    confetti();
                }
                
                setTimeout(()=>d.remove(), 2200);
        };

        const jokes = [
            "Why did the fridge apply for a job? It wanted to chill at work!",
            "What do you call a broken fridge? A cool-less wonder.",
            "Why don‚Äôt fridges ever get lonely? Because they‚Äôre always chilling with friends!",
            "What did the fridge say to the hungry kid? \"Broke ahh!\"",
            "What to do when the Fridge runs away? Catch it!",
            "It's a Knoc Knoc joke, you start!",
            "I put a new refrigerator next to a fridge, now their just chilling."
        ];
        document.getElementById("joke").innerText = jokes[Math.floor(Math.random() * jokes.length)];

        // Initial load
        loadGame();
// -------------------------
// MAIN GAME VARIABLES
// -------------------------
let money = 0;
let clickValue = 1;

let upgrades = {
    doubleClick: false,
    tripleClick: false,
    clickPowerII: false,
    confettiClick: false,
    autoClicker: false,
    autoClickerBoost: false,
    goldenDollar: false,
    luckyGambler: false,
    diceGame: false,
    blackjackGame: false,
    backgroundTheme: false
};

// -------------------------
// UPDATE WALLET DISPLAY
// -------------------------
function updateWallet() {
    document.getElementById("wallet-display").innerText = `$${money}`;
}

// -------------------------
// CLICK BUTTON MONEY
// -------------------------
document.getElementById("dollar-btn").onclick = function() {
    
    let gain = clickValue;

    if (upgrades.doubleClick) gain = 2;
    if (upgrades.tripleClick) gain = 3;
    if (upgrades.clickPowerII) gain += 1;
    if (upgrades.goldenDollar) gain *= 2;

    money += gain;
    updateWallet();

    if (upgrades.confettiClick) spawnConfetti();
};

// -------------------------
// BASIC CONFETTI EFFECT
// -------------------------
function spawnConfetti() {
    let conf = document.createElement("div");
    conf.innerHTML = "üéâ";
    conf.style.position = "fixed";
    conf.style.left = (Math.random() * 100) + "%";
    conf.style.top = "0px";
    conf.style.fontSize = "30px";
    conf.style.animation = "fall 1.5s linear";
    document.body.appendChild(conf);

    setTimeout(() => conf.remove(), 1500);
}

// -------------------------
// BUY UPGRADES
// -------------------------
function buyUpgrade(name) {
    const costs = {
        doubleClick: 50,
        tripleClick: 200,
        clickPowerII: 1500,
        confettiClick: 75,
        autoClicker: 300,
        autoClickerBoost: 1000,
        goldenDollar: 500,
        luckyGambler: 150,
        diceGame: 500,
        blackjackGame: 1000,
        backgroundTheme: 80
    };

    if (money < costs[name]) return alert("Not enough money!");

    money -= costs[name];
    upgrades[name] = true;

    updateWallet();

    document.getElementById(`buy-${name}`).style.display = "none";
    document.getElementById(`toggle-${name}`).style.display = "inline-block";

    if (name === "autoClicker") startAutoClicker();
    if (name === "autoClickerBoost") ; // handled inside auto-clicker
    if (name === "diceGame") document.getElementById("dice-game-container").style.display = "block";
    if (name === "blackjackGame") document.getElementById("blackjack-game-container").style.display = "block";

    if (name === "backgroundTheme") {
        document.body.style.background = "linear-gradient(135deg, #222, #444)";
    }
}

// -------------------------
// TOGGLE EXTRA THINGS
// -------------------------
function toggleUpgrade(name) {
    if (name === "diceGame") {
        let box = document.getElementById("dice-game-container");
        box.style.display = (box.style.display === "none") ? "block" : "none";
    }

    if (name === "blackjackGame") {
        let bj = document.getElementById("blackjack-game-container");
        bj.style.display = (bj.style.display === "none") ? "block" : "none";
    }
}

// -------------------------
// AUTO CLICKER SYSTEM
// -------------------------
function startAutoClicker() {
    setInterval(() => {
        if (!upgrades.autoClicker) return;

        let gain = upgrades.autoClickerBoost ? 5 : 1;
        money += gain;
        updateWallet();

    }, 10000); // every 10 seconds
}

// -------------------------
// GUMBALL MACHINE (SLOT MACHINE)
// -------------------------

document.getElementById("spin-btn").onclick = spinMachine;

function spinMachine() {
    const icons = ["üçí", "üçã", "‚≠ê", "üçá", "7Ô∏è‚É£", "üç¨"];

    let r1 = document.getElementById("reel1");
    let r2 = document.getElementById("reel2");
    let r3 = document.getElementById("reel3");

    r1.innerText = icons[Math.floor(Math.random() * icons.length)];
    r2.innerText = icons[Math.floor(Math.random() * icons.length)];
    r3.innerText = icons[Math.floor(Math.random() * icons.length)];

    let result = document.getElementById("gumball-result");

    if (r1.innerText === r2.innerText && r2.innerText === r3.innerText) {
        let reward = 50;
        if (upgrades.luckyGambler) reward = 100;

        money += reward;
        updateWallet();
        result.innerText = `üéâ JACKPOT! +$${reward}`;
    } else {
        result.innerText = `Try again...`;
    }
}
</script>


</body>
</html>
